<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cosmic News ‚Ä¢ Interstellar Intelligence Network</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700;900&family=Space+Grotesk:wght@300;400;500;600;700&display=swap');

        :root {
            --primary-color: #8B5CF6; /* Purple */
            --secondary-color: #06B6D4; /* Cyan */
            --accent-color: #EC4899; /* Pink */
            --background-dark: #0d0d23;
            --glass-border: rgba(138, 43, 226, 0.3);
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Space Grotesk', sans-serif;
            background: #000;
            min-height: 100vh;
            color: #fff;
            overflow: hidden; /* Prevent scrollbars during intro */
        }

        /* ========== THE GENESIS ENGINE: BIG BANG INTRO ========== */
        #intro-container {
            position: fixed;
            top: 0; left: 0;
            width: 100vw; height: 100vh;
            background: #000;
            z-index: 100000;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            opacity: 1;
            transition: opacity 1s 6s; /* Fade out after animation */
        }
        #intro-container.hidden {
            opacity: 0;
            pointer-events: none;
        }

        #particle-canvas {
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 100%;
            opacity: 0;
            animation: fadeInParticles 4s 0.2s forwards;
        }
        @keyframes fadeInParticles {
            to { opacity: 1; }
        }

        #big-bang-flash {
            position: absolute;
            width: 10px; height: 10px;
            border-radius: 50%;
            background: #fff;
            box-shadow: 0 0 150px 70px #fff, 0 0 250px 150px #fefde8;
            transform: scale(0);
            animation: bigBangExplosion 1s 0.1s cubic-bezier(0.25, 1, 0.5, 1) forwards;
        }
        @keyframes bigBangExplosion {
            0% { transform: scale(0); }
            70% { transform: scale(1.5); opacity: 1; }
            100% { transform: scale(0.8); opacity: 0; }
        }

        .intro-solar-system {
            position: relative;
            width: 100vmin;
            height: 100vmin;
            transform: scale(0);
            opacity: 0;
            animation: materializeSystem 2s 2s forwards, collapseSystem 1s 6s forwards;
        }
        @keyframes materializeSystem {
            from { transform: scale(0); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        @keyframes collapseSystem {
            from { transform: scale(1) rotate(0deg); opacity: 1; }
            to { transform: scale(0) rotate(360deg); opacity: 0; }
        }

        .intro-orbit {
            position: absolute;
            top: 50%; left: 50%;
            border: 1px solid rgba(255, 255, 255, 0.05);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            animation: materializeOrbit 2s 2.5s backwards;
        }
        @keyframes materializeOrbit { from { opacity: 0; } to { opacity: 1; } }

        .intro-planet { position: absolute; top: 50%; left: 50%; border-radius: 50%; transform-origin: center; }
        .intro-sun { position: absolute; top: 50%; left: 50%; width: 10%; height: 10%; background: radial-gradient(circle, #ffcc33 0%, #ff6600 100%); border-radius: 50%; transform: translate(-50%, -50%); box-shadow: 0 0 50px #ffcc33, 0 0 100px #ff6600; }

        .mercury { --size: 1%; --distance: 10%; --duration: 8.8s; background: #9f9f9f; }
        .venus { --size: 2%; --distance: 15%; --duration: 12.5s; background: #e6d3a2; }
        .earth { --size: 2.2%; --distance: 21%; --duration: 20s; background: #4f86f7; }
        .mars { --size: 1.5%; --distance: 28%; --duration: 37.6s; background: #c1440e; }
        .jupiter { --size: 5%; --distance: 38%; --duration: 53.4s; background: #d8ca9d; }
        .saturn { --size: 4%; --distance: 50%; --duration: 78.4s; background: #e0d8b4; }
        .uranus { --size: 3%; --distance: 62%; --duration: 94s; background: #afdbf5; }
        .neptune { --size: 2.8%; --distance: 72%; --duration: 125s; background: #3f54ba; }

        .intro-orbit { width: calc(var(--distance) * 2); height: calc(var(--distance) * 2); }
        .intro-planet { width: var(--size); height: var(--size); animation: orbit var(--duration) linear infinite; }
        
        @keyframes orbit {
            from { transform: translate(-50%, -50%) rotate(0deg) translateX(calc(var(--distance) / var(--size) * 50%)) rotate(0deg); }
            to { transform: translate(-50%, -50%) rotate(360deg) translateX(calc(var(--distance) / var(--size) * 50%)) rotate(-360deg); }
        }
        .saturn::after { content: ''; position: absolute; top: 50%; left: 50%; width: 200%; height: 200%; border-radius: 50%; border: 10% solid rgba(255, 255, 255, 0.3); transform: translate(-50%, -50%) rotateX(70deg); }

        .main-app-content { opacity: 0; transition: opacity 1s 6.5s; /* Fade in after intro */ }
        .main-app-content.visible { opacity: 1; }

        /* ========== ASTRONOMY BACKGROUND ========== */
        .space-background { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: radial-gradient(ellipse at bottom, #1b2735 0%, #090a0f 100%); z-index: 0; }
        .nebula { position: fixed; width: 100%; height: 100%; top: 0; left: 0; background: radial-gradient(ellipse at 20% 30%, rgba(138, 43, 226, 0.15) 0%, transparent 50%), radial-gradient(ellipse at 80% 70%, rgba(0, 191, 255, 0.15) 0%, transparent 50%), radial-gradient(ellipse at 50% 50%, rgba(255, 20, 147, 0.1) 0%, transparent 50%); animation: nebulaPulse 20s ease-in-out infinite; z-index: 1; }
        @keyframes nebulaPulse { 0%, 100% { opacity: 0.4; transform: scale(1); } 50% { opacity: 0.7; transform: scale(1.05); } }
        #stars-container { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 2; pointer-events: none; }
        .star { position: absolute; background: white; border-radius: 50%; animation: twinkle linear infinite; }
        @keyframes twinkle { 0%, 100% { opacity: 0.2; transform: scale(1); } 50% { opacity: 1; transform: scale(1.5); } }
        .meteor { position: fixed; width: 2px; height: 2px; background: white; border-radius: 50%; box-shadow: 0 0 10px 2px rgba(255, 255, 255, 0.8); animation: shootingStar 3s linear infinite; z-index: 3; }
        @keyframes shootingStar { 0% { transform: translate(0, 0); opacity: 1; } 100% { transform: translate(-300px, 300px); opacity: 0; } }

        /* ========== GALAXY LOADING ========== */
        .galaxy-loading { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.95); display: flex; justify-content: center; align-items: center; z-index: 9999; flex-direction: column; transition: opacity 0.5s; }
        .galaxy-spinner { position: relative; width: 200px; height: 200px; }
        .galaxy-spinner-core { position: absolute; top: 50%; left: 50%; width: 40px; height: 40px; background: radial-gradient(circle, #fff 0%, var(--primary-color) 100%); border-radius: 50%; transform: translate(-50%, -50%); box-shadow: 0 0 40px var(--primary-color), 0 0 80px var(--primary-color); animation: galaxyCorePulse 2s ease-in-out infinite; }
        @keyframes galaxyCorePulse { 0%, 100% { transform: translate(-50%, -50%) scale(1); } 50% { transform: translate(-50%, -50%) scale(1.3); } }
        .galaxy-spinner-ring { position: absolute; top: 50%; left: 50%; border: 3px solid transparent; border-top-color: var(--primary-color); border-radius: 50%; transform: translate(-50%, -50%); animation: galaxyRingRotate 3s linear infinite; }
        .galaxy-spinner-ring:nth-child(1) { width: 80px; height: 80px; border-top-color: var(--primary-color); animation-duration: 2s; }
        .galaxy-spinner-ring:nth-child(2) { width: 120px; height: 120px; border-top-color: var(--secondary-color); animation-duration: 3s; }
        .galaxy-spinner-ring:nth-child(3) { width: 160px; height: 160px; border-top-color: var(--accent-color); animation-duration: 4s; }
        .galaxy-spinner-ring:nth-child(4) { width: 200px; height: 200px; border-top-color: #F59E0B; animation-duration: 5s; }
        @keyframes galaxyRingRotate { 0% { transform: translate(-50%, -50%) rotate(0deg); } 100% { transform: translate(-50%, -50%) rotate(360deg); } }
        .loading-text { margin-top: 40px; font-family: 'Orbitron', sans-serif; font-size: 1.5em; font-weight: 700; color: #fff; text-shadow: 0 0 20px rgba(139, 92, 246, 0.8); animation: textPulse 2s ease-in-out infinite; }
        @keyframes textPulse { 0%, 100% { opacity: 0.6; } 50% { opacity: 1; } }

        /* ========== MAIN CONTENT & HEADER ========== */
        .content { position: relative; z-index: 100; padding-bottom: 100px; }
        header { position: sticky; top: 0; z-index: 1000; padding: 20px 0; background: rgba(0, 0, 0, 0.3); backdrop-filter: blur(20px); border-bottom: 1px solid var(--glass-border); box-shadow: 0 4px 30px rgba(138, 43, 226, 0.2); }
        .header-content { display: flex; justify-content: space-between; align-items: center; }
        .container { max-width: 1400px; margin: 0 auto; padding: 0 30px; }
        .logo-container { text-align: center; }
        .cosmic-logo { font-size: 3em; animation: logoFloat 6s ease-in-out infinite; filter: drop-shadow(0 0 30px var(--primary-color)); }
        @keyframes logoFloat { 0%, 100% { transform: translateY(0px) rotate(0deg); } 50% { transform: translateY(-10px) rotate(5deg); } }
        h1 { font-family: 'Orbitron', sans-serif; font-size: 2.5em; font-weight: 900; background: linear-gradient(135deg, #fff 0%, var(--primary-color) 50%, var(--secondary-color) 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; letter-spacing: 2px; text-shadow: 0 0 40px rgba(139, 92, 246, 0.5); }
        .subtitle { font-size: 0.9em; color: rgba(255, 255, 255, 0.8); letter-spacing: 1px; text-transform: uppercase; }
        #realtime-clock { font-family: 'Orbitron', sans-serif; font-size: 1.5em; font-weight: 700; color: var(--secondary-color); text-shadow: 0 0 10px var(--secondary-color), 0 0 20px var(--secondary-color); text-align: right; }
        #realtime-clock .date { font-size: 0.5em; color: rgba(255, 255, 255, 0.8); display: block; letter-spacing: 1px; }

        /* ========== FILTERS & UI ========== */
        .cosmic-glass { background: rgba(13, 13, 35, 0.4); backdrop-filter: blur(25px); border: 1px solid var(--glass-border); box-shadow: 0 8px 32px 0 rgba(138, 43, 226, 0.3), inset 0 0 20px rgba(138, 43, 226, 0.1); }
        .filters { padding: 30px; margin: 30px 0; border-radius: 25px; position: relative; overflow: hidden; }
        .filter-group { display: flex; flex-wrap: wrap; gap: 15px; align-items: center; justify-content: center; position: relative; z-index: 1; }
        .filter-group select, .filter-group input { padding: 14px 20px; border: 2px solid rgba(138, 43, 226, 0.4); border-radius: 15px; font-size: 1em; outline: none; transition: all 0.4s; background: rgba(13, 13, 35, 0.7); backdrop-filter: blur(10px); color: #fff; font-weight: 500; box-shadow: 0 4px 15px rgba(138, 43, 226, 0.2); }
        .filter-group select option { background: var(--background-dark); }
        .filter-group select:focus, .filter-group input:focus { border-color: rgba(138, 43, 226, 0.8); box-shadow: 0 8px 25px rgba(138, 43, 226, 0.4); }
        .filter-group button { padding: 14px 28px; background: linear-gradient(135deg, rgba(138, 43, 226, 0.6), rgba(6, 182, 212, 0.6)); backdrop-filter: blur(20px); color: white; border: 2px solid rgba(138, 43, 226, 0.5); border-radius: 15px; font-size: 1em; font-weight: 700; font-family: 'Orbitron', sans-serif; cursor: pointer; transition: all 0.4s; box-shadow: 0 4px 15px rgba(138, 43, 226, 0.3); text-transform: uppercase; letter-spacing: 1px; }
        .filter-group button:hover { transform: translateY(-3px); box-shadow: 0 8px 30px rgba(138, 43, 226, 0.5); }
        .view-toggle { margin-top: 20px; text-align: center; }
        .view-toggle button { background: transparent; border: 2px solid var(--primary-color); color: var(--primary-color); }
        .view-toggle button.active { background: var(--primary-color); color: white; box-shadow: 0 0 20px var(--primary-color); }
        
        /* ========== NEWS CARDS & FOLLOWING FEED ========== */
        #following-sources-container { display: flex; flex-wrap: wrap; gap: 10px; justify-content: center; margin-bottom: 20px; }
        .source-chip { display: flex; align-items: center; background: rgba(138, 43, 226, 0.3); padding: 8px 15px; border-radius: 20px; font-size: 0.9em; font-weight: 600; cursor: default; }
        .unfollow-chip-btn { background: none; border: none; color: #fff; margin-left: 10px; cursor: pointer; font-size: 1.2em; opacity: 0.7; transition: opacity 0.3s; }
        .unfollow-chip-btn:hover { opacity: 1; }
        
        #load-more-container { text-align: center; margin-top: 40px; }
        #load-more-btn { padding: 18px 40px; background: linear-gradient(135deg, rgba(138, 43, 226, 0.4), rgba(6, 182, 212, 0.4)); backdrop-filter: blur(15px); color: white; border: 2px solid rgba(138, 43, 226, 0.6); border-radius: 20px; font-size: 1.2em; font-weight: 700; font-family: 'Orbitron', sans-serif; cursor: pointer; transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); box-shadow: 0 4px 20px rgba(138, 43, 226, 0.3); text-transform: uppercase; letter-spacing: 2px; display: inline-flex; align-items: center; justify-content: center; width: auto; max-width: 400px; }
        #load-more-btn:hover { transform: translateY(-5px) scale(1.05); box-shadow: 0 10px 40px rgba(138, 43, 226, 0.6); border-color: rgba(138, 43, 226, 0.9); }
        #load-more-btn:disabled { cursor: not-allowed; opacity: 0.6; }
        .mini-spinner { width: 20px; height: 20px; border: 3px solid rgba(255,255,255,0.3); border-top-color: #fff; border-radius: 50%; display: inline-block; animation: spin 1s linear infinite; margin-left: 15px; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        .news-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(360px, 1fr)); gap: 35px; margin: 40px 0; }
        .news-card { border-radius: 25px; overflow: hidden; transition: all 0.6s; cursor: pointer; position: relative; }
        .news-card:hover { transform: translateY(-15px) scale(1.03); box-shadow: 0 15px 50px rgba(138, 43, 226, 0.5); border-color: rgba(138, 43, 226, 0.6); }
        .news-image { width: 100%; height: 230px; object-fit: cover; transition: transform 0.6s; filter: brightness(0.9); }
        .news-card:hover .news-image { transform: scale(1.15); filter: brightness(1.1); }
        .news-content { padding: 25px; }
        .news-title { font-family: 'Orbitron', sans-serif; font-size: 1.4em; margin: 15px 0; color: white; }
        .news-date { font-size: 0.9em; color: rgba(255,255,255,0.7); }
        
        /* ========== STATUS BOXES & TOAST ========== */
        .info-box, .success-box, .error { padding: 25px 30px; margin: 30px 0; border-radius: 20px; animation: slideIn 0.6s; }
        @keyframes slideIn { from { opacity: 0; transform: translateY(-30px); } to { opacity: 1; transform: translateY(0); } }
        .info-box { background: rgba(6, 182, 212, 0.2); border-left: 4px solid var(--secondary-color); }
        .info-box h3, .error h3 { font-family: 'Orbitron', sans-serif; margin-bottom: 18px; }
        .info-box a { color: var(--secondary-color); font-weight: 700; text-decoration: underline; }
        .success-box { background: rgba(16, 185, 129, 0.2); border-left: 4px solid #10B981; }
        .error { background: rgba(239, 68, 68, 0.2); border-left: 4px solid #EF4444; }
        .no-results { text-align: center; padding: 100px 20px; font-size: 1.6em; font-family: 'Orbitron', sans-serif; border-radius: 25px; }
        #toast-container { position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%); z-index: 10000; }
        .toast { padding: 15px 25px; border-radius: 15px; color: white; font-weight: 600; margin-top: 10px; box-shadow: 0 5px 20px rgba(0, 0, 0, 0.5); animation: fadeInOut 3s ease-in-out; }
        .toast.success { background: linear-gradient(135deg, #10B981, #16A34A); }
        .toast.info { background: linear-gradient(135deg, #06B6D4, #0E7490); }
        .toast.danger { background: linear-gradient(135deg, #EF4444, #B91C1C); }
        @keyframes fadeInOut { 0%, 100% { opacity: 0; transform: translateY(20px); } 10%, 90% { opacity: 1; transform: translateY(0); } }

        /* ========== BOTTOM NAVIGATION & MODALS ========== */
        .bottom-nav { position: fixed; bottom: 0; left: 0; width: 100%; height: 80px; display: none; justify-content: space-around; align-items: center; background: rgba(13, 13, 35, 0.6); backdrop-filter: blur(25px); border-top: 1px solid var(--glass-border); z-index: 1002; }
        .bottom-nav-btn { background: none; border: none; color: rgba(255, 255, 255, 0.7); font-size: 1.5em; display: flex; flex-direction: column; align-items: center; gap: 5px; cursor: pointer; transition: all 0.3s; }
        .bottom-nav-btn span { font-size: 0.5em; font-family: 'Orbitron'; }
        .bottom-nav-btn:hover { color: white; transform: translateY(-5px); }
        .bottom-nav-btn.active { color: var(--primary-color); text-shadow: 0 0 15px var(--primary-color); }
        
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); backdrop-filter: blur(10px); z-index: 10001; display: none; justify-content: center; align-items: center; padding: 20px; }
        .modal-content { width: 100%; max-width: 500px; padding: 30px; border-radius: 25px; position: relative; animation: modal-swoop 0.5s ease-out; }
        @keyframes modal-swoop { from { opacity: 0; transform: translateY(-50px) scale(0.9); } to { opacity: 1; transform: translateY(0) scale(1); } }
        .modal-close-btn { position: absolute; top: 15px; right: 20px; font-size: 2.5em; color: white; cursor: pointer; background: none; border: none; }
        
        #article-viewer-modal .modal-content { max-width: 800px; max-height: 90vh; overflow-y: auto; }
        #article-viewer-image { width: 100%; height: 300px; object-fit: cover; border-radius: 20px; margin-bottom: 20px; }
        #article-viewer-title { font-family: 'Orbitron'; font-size: 2em; margin-bottom: 15px; }
        #article-viewer-description { font-size: 1.1em; line-height: 1.8; opacity: 0.9; margin-bottom: 30px; }
        .article-viewer-actions { display: flex; flex-wrap: wrap; gap: 15px; justify-content: center; }
        .article-viewer-actions button { flex-grow: 1; }

        .settings-item { display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; }
        .toggle-switch { position: relative; display: inline-block; width: 60px; height: 34px; }
        .toggle-switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: rgba(255,255,255,0.2); transition: .4s; border-radius: 34px; }
        .slider:before { position: absolute; content: ""; height: 26px; width: 26px; left: 4px; bottom: 4px; background-color: white; transition: .4s; border-radius: 50%; }
        input:checked + .slider { background-color: var(--primary-color); box-shadow: 0 0 15px var(--primary-color); }
        input:checked + .slider:before { transform: translateX(26px); }
        .btn-danger { background: linear-gradient(135deg, #EF4444, #B91C1C) !important; border-color: #EF4444 !important; }

        /* ========== FOOTER & BACK TO TOP ========== */
        footer { padding: 50px 20px; margin-top: 80px; text-align:center; border-top: 1px solid var(--glass-border); }
        #back-to-top { position: fixed; bottom: 40px; right: 40px; width: 60px; height: 60px; background: linear-gradient(135deg, var(--primary-color), var(--secondary-color)); border-radius: 50%; border: none; cursor: pointer; z-index: 1001; display: flex; justify-content: center; align-items: center; font-size: 2em; color: white; box-shadow: 0 0 30px var(--primary-color); transition: all 0.4s; transform: translateY(150px); }
        #back-to-top.visible { transform: translateY(0); }
        #back-to-top:hover { transform: scale(1.1); box-shadow: 0 0 40px var(--primary-color); }

        /* ========== RESPONSIVE & SCROLLBAR ========== */
        @media (max-width: 768px) {
            .header-content { flex-direction: column; gap: 15px; }
            h1 { font-size: 2em; }
            #realtime-clock { text-align: center; }
            .news-grid { grid-template-columns: 1fr; }
            .filter-group { flex-direction: column; }
            .filter-group select, .filter-group input, .filter-group button { width: 100%; }
            .view-toggle { display: none; }
            .bottom-nav { display: flex; }
            #back-to-top { bottom: 100px; }
        }
        ::-webkit-scrollbar { width: 14px; }
        ::-webkit-scrollbar-track { background: rgba(0, 0, 0, 0.5); }
        ::-webkit-scrollbar-thumb { background: linear-gradient(180deg, var(--primary-color), var(--secondary-color)); border-radius: 10px; border: 2px solid transparent; background-clip: padding-box; }
    </style>
</head>
<body>
    <div id="intro-container">
        <canvas id="particle-canvas"></canvas>
        <div id="big-bang-flash"></div>
        <div class="intro-solar-system">
            <div class="intro-sun"></div>
            <div class="intro-orbit mercury"><div class="intro-planet mercury"></div></div>
            <div class="intro-orbit venus"><div class="intro-planet venus"></div></div>
            <div class="intro-orbit earth"><div class="intro-planet earth"></div></div>
            <div class="intro-orbit mars"><div class="intro-planet mars"></div></div>
            <div class="intro-orbit jupiter"><div class="intro-planet jupiter"></div></div>
            <div class="intro-orbit saturn"><div class="intro-planet saturn"></div></div>
            <div class="intro-orbit uranus"><div class="intro-planet uranus"></div></div>
            <div class="intro-orbit neptune"><div class="intro-planet neptune"></div></div>
        </div>
    </div>
    
    <div class="main-app-content">
        <!-- Background Elements -->
        <div class="space-background"></div> <div class="nebula"></div>
        <div id="stars-container"></div> <div id="meteors"></div>

        <!-- Galaxy Loading Animation -->
        <div class="galaxy-loading" id="galaxyLoading" style="display: none;">
            <div class="galaxy-spinner"><div class="galaxy-spinner-core"></div><div class="galaxy-spinner-ring"></div><div class="galaxy-spinner-ring"></div><div class="galaxy-spinner-ring"></div><div class="galaxy-spinner-ring"></div></div>
            <div class="loading-text">Exploring The Cosmos...</div>
        </div>

        <!-- Modals -->
        <div class="modal-overlay" id="settings-modal">
            <div class="modal-content cosmic-glass">
                <button class="modal-close-btn" onclick="toggleSettingsModal(false)">&times;</button>
                <h2 style="font-family: 'Orbitron'; text-align: center; margin-bottom: 30px;">‚öôÔ∏è PENGATURAN</h2>
                <div class="settings-item">
                    <label for="save-filters-toggle">Simpan Filter Default</label>
                    <label class="toggle-switch"><input type="checkbox" id="save-filters-toggle" onchange="toggleSaveFilters(this.checked)"><span class="slider"></span></label>
                </div>
                <div class="settings-item">
                    <span>Reset Semua Data</span>
                    <button class="filter-group-btn btn-danger" onclick="resetAllData()">RESET</button>
                </div>
                <p style="font-size: 0.8em; text-align: center; opacity: 0.7; margin-top: 30px;">Tindakan reset akan menghapus API Key, Favorit, dan semua pengaturan.</p>
            </div>
        </div>
        <div class="modal-overlay" id="article-viewer-modal">
            <div class="modal-content cosmic-glass">
                <button class="modal-close-btn" onclick="closeArticleViewer()">&times;</button>
                <img id="article-viewer-image" src="" alt="Article Image">
                <h2 id="article-viewer-title"></h2>
                <p id="article-viewer-description"></p>
                <div class="article-viewer-actions filter-group">
                    <button id="viewer-follow-btn" onclick="handleViewerFollow()">üì° Ikuti Sumber</button>
                    <button id="viewer-fav-btn" onclick="handleViewerFavorite()">‚≠ê Tambah ke Favorit</button>
                    <button id="viewer-share-btn" onclick="handleViewerShare()">üîó Bagikan</button>
                    <button id="viewer-open-btn" onclick="handleViewerOpenOriginal()">üåê Buka Asli</button>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="content">
            <header>
                <div class="container header-content">
                    <div class="logo-container"> <div class="cosmic-logo">üåå</div> <h1>COSMIC NEWS</h1> <p class="subtitle">Interstellar Intelligence Network</p> </div>
                    <div id="realtime-clock"> <span class="time">00:00:00</span> <span class="date">YYYY-MM-DD</span> </div>
                </div>
            </header>

            <div class="container">
                <div class="info-box cosmic-glass">
                    <h3>üöÄ Mission Control</h3>
                    <p>Menggunakan API Key default. Untuk pengalaman penuh, <a href="https://newsdata.io/register" target="_blank">daftar</a> dan ganti API key di bawah.</p>
                </div>

                <div class="filters cosmic-glass">
                    <div class="filter-group">
                        <input type="text" id="apiKeyInput" placeholder="üîë Ganti API Key di sini (opsional)" style="min-width: 350px;">
                        <button onclick="saveApiKey()">üíæ Save</button>
                        <button onclick="testApiKey()" style="background: linear-gradient(135deg, rgba(16, 185, 129, 0.6), rgba(6, 182, 212, 0.6));">üß™ Test</button>
                    </div>
                    <div class="filter-group view-toggle">
                        <button id="btn-all-news" class="active" onclick="setView('all')">üõ∞Ô∏è All News</button>
                        <button id="btn-following" onclick="setView('following')">üì° Following</button>
                        <button id="btn-favorites" onclick="setView('favorites')">‚≠ê My Favorites</button>
                    </div>
                    <div class="filter-group" style="margin-top: 20px;">
                        <select id="category"><option value="">üìÇ All Sectors</option><option value="business">üíº Business</option><option value="technology">üíª Technology</option><option value="top">üî• Trending</option><option value="science">üî¨ Science</option><option value="sports">‚öΩ Sports</option><option value="health">üè• Health</option></select>
                        <select id="country"><option value="">üåç All Galaxies</option><option value="us">üá∫üá∏ USA</option><option value="id">üáÆüá© Indonesia</option><option value="jp">üáØüáµ Japan</option><option value="gb">üá¨üáß UK</option><option value="au">üá¶üá∫ Australia</option></select>
                        <select id="language"><option value="">üó£Ô∏è All Languages</option><option value="en">üá¨üáß English</option><option value="id">üáÆüá© Indonesia</option></select>
                        <input type="text" id="searchInput" placeholder="üîç Search cosmos...">
                        <button onclick="searchNews()">üîç Search</button> <button onclick="loadNews(true)">üîÑ Transmit</button>
                    </div>
                </div>

                <div id="statusContainer"></div> <div id="errorContainer"></div>
                <div id="following-sources-container" class="cosmic-glass" style="display: none; padding: 20px; border-radius: 20px; margin-bottom: 20px;"></div>
                <div id="newsContainer" class="news-grid"></div>
                <div id="load-more-container" style="display: none;">
                    <button id="load-more-btn" onclick="loadMoreNews()">Load More Signals</button>
                </div>
            </div>

            <footer>
                <p>¬© 2025 COSMIC NEWS ‚Ä¢ Interstellar Intelligence Network</p>
                <p>Crafted with üåü for Commander The Legend Prime of Hoshi's</p>
            </footer>
        </div>
        
        <div id="toast-container"></div>
        <button id="back-to-top" onclick="scrollToTop()">üöÄ</button>

        <nav class="bottom-nav">
            <button class="bottom-nav-btn" id="bottom-nav-news" onclick="setView('all')">üõ∞Ô∏è<span>Berita</span></button>
            <button class="bottom-nav-btn" id="bottom-nav-following" onclick="setView('following')">üì°<span>Mengikuti</span></button>
            <button class="bottom-nav-btn" id="bottom-nav-favorites" onclick="setView('favorites')">‚≠ê<span>Favorit</span></button>
            <button class="bottom-nav-btn" onclick="toggleSettingsModal(true)">‚öôÔ∏è<span>Pengaturan</span></button>
        </nav>
    </div>

    <script>
        // ========== THE GENESIS ENGINE & APP INITIALIZATION ==========
        window.addEventListener('load', () => {
            const introContainer = document.getElementById('intro-container');
            const mainContent = document.querySelector('.main-app-content');
            const canvas = document.getElementById('particle-canvas');
            const ctx = canvas.getContext('2d');
            
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;

            let particles = [];
            const numParticles = 2000;

            // Particle Creation
            for(let i = 0; i < numParticles; i++) {
                particles.push({
                    x: canvas.width / 2,
                    y: canvas.height / 2,
                    vx: (Math.random() - 0.5) * (Math.random() * 20),
                    vy: (Math.random() - 0.5) * (Math.random() * 20),
                    size: Math.random() * 2 + 0.5,
                    alpha: Math.random() * 0.5 + 0.5,
                    decay: Math.random() * 0.01 + 0.98
                });
            }

            function animateParticles() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                particles.forEach(p => {
                    p.x += p.vx;
                    p.y += p.vy;
                    p.vx *= p.decay;
                    p.vy *= p.decay;
                    p.alpha -= 0.005;

                    if(p.alpha > 0) {
                        ctx.fillStyle = `rgba(255, 255, 255, ${p.alpha})`;
                        ctx.beginPath();
                        ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
                        ctx.fill();
                    }
                });
                requestAnimationFrame(animateParticles);
            }

            setTimeout(() => { // Start particle animation slightly after the flash
                requestAnimationFrame(animateParticles);
            }, 200);

            // Transition to main app
            setTimeout(() => {
                introContainer.classList.add('hidden');
                mainContent.classList.add('visible');
                document.body.style.overflow = 'auto'; // Re-enable scroll
            }, 6800);

            // Defer main app logic until after intro
            initializeApp();

            // Background stars for the main app
            const starsContainer = document.getElementById('stars-container');
            for (let i = 0; i < 200; i++) {
                const star = document.createElement('div'); star.className = 'star';
                star.style.left = `${Math.random() * 100}%`; star.style.top = `${Math.random() * 100}%`;
                const size = Math.random() * 3; star.style.width = `${size}px`; star.style.height = `${size}px`;
                star.dataset.depth = Math.random() * 0.5 + 0.1; star.style.animationDuration = `${Math.random() * 3 + 2}s`;
                starsContainer.appendChild(star);
            }
            window.addEventListener('scroll', () => {
                const top = window.pageYOffset;
                document.querySelectorAll('.star').forEach(star => { star.style.transform = `translateY(${-(top * star.dataset.depth)}px)`; });
            });
            setInterval(() => {
                const meteor = document.createElement('div'); meteor.className = 'meteor';
                meteor.style.left = `${Math.random() * 100}%`; meteor.style.animationDuration = `${Math.random() * 2 + 2}s`;
                mainContent.querySelector('#meteors').appendChild(meteor);
                setTimeout(() => meteor.remove(), 3000);
            }, 3000);
        });

        // ========== API & CORE LOGIC ==========
        const API_BASE_URL = 'https://newsdata.io/api/1';
        const DEFAULT_API_KEY = 'pub_f2c79afae84d4ffba8bfdc6f542d7693';
        let API_KEY = localStorage.getItem('newsdata_api_key') || DEFAULT_API_KEY;
        let currentView = 'all'; let favorites = JSON.parse(localStorage.getItem('cosmic_favorites')) || [];
        let following = JSON.parse(localStorage.getItem('cosmic_following')) || [];
        let saveFiltersEnabled = (localStorage.getItem('cosmic_save_filters_enabled') || 'true') === 'true';
        let currentArticleInViewer = null; let nextPageToken = null; let currentUrlForPaging = '';

        function initializeApp() {
            document.getElementById('save-filters-toggle').checked = saveFiltersEnabled;
            if (saveFiltersEnabled) loadFilters();
            document.getElementById('apiKeyInput').value = API_KEY === DEFAULT_API_KEY ? '' : API_KEY;
            loadNews(true); // Initial load
            updateClock(); setInterval(updateClock, 1000); setView(currentView);
        }

        const showGalaxyLoading = (show) => { document.getElementById('galaxyLoading').style.display = show ? 'flex' : 'none'; };
        const showToast = (message, type = 'info') => {
            const container = document.getElementById('toast-container');
            const toast = document.createElement('div'); toast.className = `toast ${type}`; toast.textContent = message; container.appendChild(toast);
            setTimeout(() => toast.remove(), 3000);
        };
        
        function saveApiKey() {
            let userKey = document.getElementById('apiKeyInput').value.trim();
            if (userKey) { API_KEY = userKey; localStorage.setItem('newsdata_api_key', API_KEY); showToast('New API Key saved!', 'success'); } 
            else { API_KEY = DEFAULT_API_KEY; localStorage.removeItem('newsdata_api_key'); showToast('Switched to default API Key.', 'info'); }
        }
        
        function saveFilters() { if (!saveFiltersEnabled) return; localStorage.setItem('cosmic_filter_category', document.getElementById('category').value); localStorage.setItem('cosmic_filter_country', document.getElementById('country').value); localStorage.setItem('cosmic_filter_language', document.getElementById('language').value); }
        function loadFilters() { document.getElementById('category').value = localStorage.getItem('cosmic_filter_category') || ''; document.getElementById('country').value = localStorage.getItem('cosmic_filter_country') || ''; document.getElementById('language').value = localStorage.getItem('cosmic_filter_language') || ''; }

        async function fetchNews(url, isLoadMore = false) {
            const loadMoreBtn = document.getElementById('load-more-btn');
            if (!isLoadMore) { showGalaxyLoading(true); document.getElementById('newsContainer').innerHTML = ''; nextPageToken = null; }
            else { loadMoreBtn.disabled = true; loadMoreBtn.innerHTML = 'Loading... <span class="mini-spinner"></span>'; }
            
            currentUrlForPaging = url;
            const fetchUrl = isLoadMore && nextPageToken ? `${url}&page=${nextPageToken}` : url;

            try {
                const response = await fetch(fetchUrl); const data = await response.json();
                if (data.status === 'success' && data.results?.length > 0) {
                    displayArticles(data.results, isLoadMore);
                    nextPageToken = data.nextPage;
                    document.getElementById('load-more-container').style.display = nextPageToken ? 'block' : 'none';
                    if (!isLoadMore) showStatus(`‚úÖ ${data.results.length} transmissions received!`, 'success');
                } else if (!isLoadMore) {
                    document.getElementById('newsContainer').innerHTML = '<div class="no-results cosmic-glass">üì≠ No signals detected.</div>';
                    document.getElementById('load-more-container').style.display = 'none';
                } else {
                    document.getElementById('load-more-container').style.display = 'none';
                    showToast('End of the transmission.', 'info');
                }
            } catch (error) { showError('‚ùå Transmission failed.'); }
            finally { if (!isLoadMore) showGalaxyLoading(false); loadMoreBtn.disabled = false; loadMoreBtn.innerHTML = 'Load More Signals'; }
        }

        const loadNews = (force = false) => {
            if (!force && currentView !== 'all') return;
            saveFilters();
            let url = `${API_BASE_URL}/news?apikey=${API_KEY}`;
            const category = document.getElementById('category').value, country = document.getElementById('country').value, language = document.getElementById('language').value;
            if (category) url += `&category=${category}`; if (country) url += `&country=${country}`; if (language) url += `&language=${language}`;
            fetchNews(url);
        };
        const searchNews = () => {
            setView('all'); saveFilters();
            const query = document.getElementById('searchInput').value.trim(); if (!query) { loadNews(); return; }
            let url = `${API_BASE_URL}/news?apikey=${API_KEY}&q=${encodeURIComponent(query)}`;
            const language = document.getElementById('language').value; if (language) url += `&language=${language}`;
            fetchNews(url);
        };
        const loadFollowingNews = () => {
            if (following.length === 0) { document.getElementById('newsContainer').innerHTML = '<div class="no-results cosmic-glass">üì° Not following any sources.</div>'; document.getElementById('load-more-container').style.display = 'none'; return; }
            const domains = following.join(','); let url = `${API_BASE_URL}/news?apikey=${API_KEY}&domain=${domains}`; fetchNews(url);
        };
        const loadMoreNews = () => { if (currentUrlForPaging && nextPageToken) fetchNews(currentUrlForPaging, true); };

        const displayArticles = (articles, isLoadMore = false) => {
            const container = document.getElementById('newsContainer'); if (!isLoadMore) container.innerHTML = '';
            articles.forEach(article => container.appendChild(createNewsCard(article)));
        };

        function createNewsCard(article) {
            const card = document.createElement('div'); card.className = 'news-card cosmic-glass';
            const imageUrl = article.image_url || `https://dummyimage.com/600x400/8B5CF6/fff.png&text=üåå`;
            card.innerHTML = `<img src="${imageUrl}" alt="${article.title}" class="news-image" onerror="this.src='https://dummyimage.com/600x400/8B5CF6/fff.png&text=üåå'"><div class="news-content"><h2 class="news-title">${article.title}</h2><span class="news-date">üìÖ ${new Date(article.pubDate).toLocaleDateString('id-ID')}</span></div>`;
            card.dataset.article = JSON.stringify(article); card.onclick = () => openArticleViewer(article); return card;
        }

        function openArticleViewer(article) {
            currentArticleInViewer = article;
            const modal = document.getElementById('article-viewer-modal');
            const favBtn = document.getElementById('viewer-fav-btn'), followBtn = document.getElementById('viewer-follow-btn');
            const isSaved = favorites.some(fav => fav.link === article.link); const isFollowing = article.source_id && following.includes(article.source_id);
            document.getElementById('article-viewer-image').src = article.image_url || `https://dummyimage.com/800x400/8B5CF6/fff.png&text=üåå`;
            document.getElementById('article-viewer-title').textContent = article.title; document.getElementById('article-viewer-description').textContent = article.description || article.content || "No description available.";
            favBtn.textContent = isSaved ? '‚≠ê Tersimpan' : '‚≠ê Tambah ke Favorit'; favBtn.style.background = isSaved ? 'var(--primary-color)' : '';
            followBtn.textContent = isFollowing ? `üì° Mengikuti ${article.source_id}` : `üì° Ikuti ${article.source_id}`; followBtn.style.background = isFollowing ? 'var(--primary-color)' : '';
            followBtn.style.display = article.source_id ? 'flex' : 'none'; modal.style.display = 'flex';
        }
        function closeArticleViewer() { document.getElementById('article-viewer-modal').style.display = 'none'; currentArticleInViewer = null; }
        function handleViewerFavorite() {
            if (!currentArticleInViewer) return;
            const articleIndex = favorites.findIndex(fav => fav.link === currentArticleInViewer.link); const favBtn = document.getElementById('viewer-fav-btn');
            if (articleIndex > -1) { favorites.splice(articleIndex, 1); favBtn.textContent = '‚≠ê Tambah ke Favorit'; favBtn.style.background = ''; showToast('Removed from Favorites!', 'info'); }
            else { favorites.push(currentArticleInViewer); favBtn.textContent = '‚≠ê Tersimpan'; favBtn.style.background = 'var(--primary-color)'; showToast('Saved to Favorites!', 'success'); }
            localStorage.setItem('cosmic_favorites', JSON.stringify(favorites)); if (currentView === 'favorites') setView('favorites');
        }
        function handleViewerFollow() {
            if (!currentArticleInViewer || !currentArticleInViewer.source_id) { showToast('Source ID not available.', 'danger'); return; }
            const sourceId = currentArticleInViewer.source_id; const sourceIndex = following.indexOf(sourceId); const followBtn = document.getElementById('viewer-follow-btn');
            if (sourceIndex > -1) { following.splice(sourceIndex, 1); followBtn.textContent = `üì° Ikuti ${sourceId}`; followBtn.style.background = ''; showToast(`Unfollowed ${sourceId}!`, 'info'); }
            else { following.push(sourceId); followBtn.textContent = `üì° Mengikuti ${sourceId}`; followBtn.style.background = 'var(--primary-color)'; showToast(`Now following ${sourceId}!`, 'success'); }
            localStorage.setItem('cosmic_following', JSON.stringify(following)); if (currentView === 'following') setView('following');
        }
        function handleViewerShare() { if (currentArticleInViewer) shareArticle(event, currentArticleInViewer.link); }
        function handleViewerOpenOriginal() { if (currentArticleInViewer) window.open(currentArticleInViewer.link, '_blank'); }

        function setView(view) {
            currentView = view;
            document.querySelectorAll('.view-toggle button, .bottom-nav-btn').forEach(btn => btn.classList.remove('active'));
            ['btn-all-news', 'bottom-nav-news'].forEach(id => document.getElementById(id).classList.toggle('active', view === 'all'));
            ['btn-favorites', 'bottom-nav-favorites'].forEach(id => document.getElementById(id).classList.toggle('active', view === 'favorites'));
            ['btn-following', 'bottom-nav-following'].forEach(id => document.getElementById(id).classList.toggle('active', view === 'following'));
            
            document.getElementById('statusContainer').innerHTML = ''; document.getElementById('errorContainer').innerHTML = '';
            document.getElementById('following-sources-container').style.display = 'none'; document.getElementById('load-more-container').style.display = 'none';

            if (view === 'favorites') {
                if (favorites.length > 0) { displayArticles(favorites); } else { document.getElementById('newsContainer').innerHTML = '<div class="no-results cosmic-glass">‚≠ê Belum ada berita favorit yang disimpan.</div>'; }
            } else if (view === 'following') {
                displayFollowingSources(); loadFollowingNews();
            } else { loadNews(true); }
        }
        function displayFollowingSources() {
            const container = document.getElementById('following-sources-container'); container.style.display = 'block'; container.innerHTML = '';
            if (following.length > 0) {
                following.forEach(sourceId => {
                    const chip = document.createElement('div'); chip.className = 'source-chip';
                    chip.innerHTML = `${sourceId} <button class="unfollow-chip-btn" onclick="unfollowSource('${sourceId}')">&times;</button>`;
                    container.appendChild(chip);
                });
            } else { container.innerHTML = '<p style="text-align: center; width: 100%;">You are not following any sources.</p>'; }
        }
        function unfollowSource(sourceId) {
            const sourceIndex = following.indexOf(sourceId);
            if (sourceIndex > -1) { following.splice(sourceIndex, 1); localStorage.setItem('cosmic_following', JSON.stringify(following)); showToast(`Unfollowed ${sourceId}!`, 'info'); setView('following'); }
        }
        
        function toggleSettingsModal(show) { document.getElementById('settings-modal').style.display = show ? 'flex' : 'none'; }
        function toggleSaveFilters(enabled) { saveFiltersEnabled = enabled; localStorage.setItem('cosmic_save_filters_enabled', enabled); showToast(`Default Filters ${enabled ? 'Enabled' : 'Disabled'}`, 'info'); }
        function resetAllData() {
            if (confirm('Yakin ingin mereset semua data? Tindakan ini akan menghapus API Key, Favorit, Mengikuti, dan Pengaturan.')) {
                localStorage.clear(); showToast('Semua data berhasil direset!', 'danger'); setTimeout(() => window.location.reload(), 1500);
            }
        }
        const updateClock = () => {
            const now = new Date();
            const optionsDate = { timeZone: 'Asia/Jakarta', weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            const optionsTime = { timeZone: 'Asia/Jakarta', hour12: false, hour: '2-digit', minute: '2-digit', second: '2-digit' };
            const dateString = now.toLocaleDateString('id-ID', optionsDate); const timeString = now.toLocaleTimeString('en-GB', optionsTime);
            const clockEl = document.getElementById('realtime-clock');
            clockEl.querySelector('.time').textContent = timeString; clockEl.querySelector('.date').textContent = `${dateString} (WIB)`;
        };
        const backToTopBtn = document.getElementById('back-to-top');
        window.addEventListener('scroll', () => { backToTopBtn.classList.toggle('visible', window.scrollY > 300); });
        const scrollToTop = () => window.scrollTo({ top: 0, behavior: 'smooth' });
        
        function shareArticle(event, url) {
            event.stopPropagation();
            if (navigator.share) { navigator.share({ title: 'Check out this Cosmic News!', url: url }); } else { navigator.clipboard.writeText(url); showToast('Article link copied!', 'info'); }
        }
        
        const showStatus = (message, type) => { document.getElementById('statusContainer').innerHTML = `<div class="cosmic-glass ${type === 'success' ? 'success-box' : 'info-box'}">${message}</div>`; };
        const showError = (message) => { document.getElementById('errorContainer').innerHTML = `<div class="error cosmic-glass"><h3>${message}</h3></div>`; };
        
        document.getElementById('searchInput').addEventListener('keypress', e => { if (e.key === 'Enter') searchNews(); });
        document.getElementById('apiKeyInput').addEventListener('keypress', e => { if (e.key === 'Enter') saveApiKey(); });
    </script>
</body>
</html>